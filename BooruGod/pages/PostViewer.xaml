<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:BooruGod.Functions.MediaPlayer"
             x:Class="BooruGod.pages.PostViewer"
             Title="Post Viewer"
             BackgroundColor="#F5F5F5">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Modern Header -->
        <Border Grid.Row="0" 
                BackgroundColor="White" 
                Stroke="Transparent" 
                StrokeThickness="0"
                Padding="20,15"
                Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Button x:Name="BackButton"
                        Grid.Column="0"
                        Text="â†"
                        FontSize="24"
                        FontAttributes="Bold"
                        BackgroundColor="Transparent"
                        TextColor="#2196F3"
                        BorderColor="Transparent"
                        BorderWidth="0"
                        Padding="10,5"
                        Clicked="OnBackClicked" />

                <Label x:Name="TitleLabel"
                       Grid.Column="1"
                       Text="Post Details"
                       FontSize="18"
                       FontAttributes="Bold"
                       TextColor="#333333"
                       HorizontalOptions="Center"
                       VerticalOptions="Center" />

                <StackLayout Grid.Column="2" 
                            Orientation="Horizontal" 
                            Spacing="8">
                                         <Border BackgroundColor="#4CAF50"
                             Stroke="Transparent"
                             StrokeThickness="0"
                             StrokeShape="RoundRectangle 20"
                             Padding="12,8">
                        <Button x:Name="OpenFullButton"
                                Text="ðŸ”—"
                                FontSize="16"
                                BackgroundColor="Transparent"
                                TextColor="White"
                                BorderColor="Transparent"
                                BorderWidth="0"
                                Padding="0"
                                Clicked="OnOpenFullClicked" />
                    </Border>
                                         <Border BackgroundColor="#FF9800"
                             Stroke="Transparent"
                             StrokeThickness="0"
                             StrokeShape="RoundRectangle 20"
                             Padding="12,8">
                        <Button x:Name="ViewCommentsButton"
                                Text="ðŸ’¬"
                                FontSize="16"
                                BackgroundColor="Transparent"
                                TextColor="White"
                                BorderColor="Transparent"
                                BorderWidth="0"
                                Padding="0"
                                Clicked="OnViewCommentsClicked" />
                    </Border>
                </StackLayout>
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollView Grid.Row="1" Padding="15">
            <StackLayout Spacing="15">
                
                <!-- Media Card (Image or Video) -->
                <Border BackgroundColor="White" 
                        Stroke="Transparent" 
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 12"
                        Padding="0"
                        Margin="0,0,0,15">
                    <Grid>
                        <!-- Image Display -->
                        <Image x:Name="PostImage"
                               Aspect="AspectFit"
                               HorizontalOptions="Center"
                               MaximumHeightRequest="350"
                               Margin="15"
                               IsVisible="False" />
                        
                        <!-- Video Player -->
                        <Border x:Name="VideoPlayer"
                                IsVisible="False"
                                BackgroundColor="#000000"
                                StrokeShape="RoundRectangle 12"
                                Margin="15">
                            <local:VideoPlayer x:Name="CustomVideoPlayer"
                                              HeightRequest="350"
                                              HorizontalOptions="FillAndExpand" />
                        </Border>
                    </Grid>
                </Border>

                <!-- Tags Card -->
                <Border BackgroundColor="White" 
                        Stroke="Transparent" 
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 12"
                        Padding="20">
                    <StackLayout Spacing="12">
                        <Label Text="ðŸ·ï¸ Tags"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#333333" />
                                                 <Border BackgroundColor="#F8F9FA"
                                 Stroke="Transparent"
                                 StrokeThickness="0"
                                 StrokeShape="RoundRectangle 8"
                                 Padding="12,8">
                             <Label x:Name="TagsLabel"
                                    Text=""
                                    FontSize="14"
                                    TextColor="#666666"
                                    LineBreakMode="WordWrap"
                                    BackgroundColor="Transparent" />
                         </Border>
                    </StackLayout>
                </Border>

                <!-- Details Card -->
                <Border BackgroundColor="White" 
                        Stroke="Transparent" 
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 12"
                        Padding="20">
                    <StackLayout Spacing="12">
                        <Label Text="ðŸ“Š Details"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#333333" />
                                                 <Border BackgroundColor="#F8F9FA"
                                 Stroke="Transparent"
                                 StrokeThickness="0"
                                 StrokeShape="RoundRectangle 8"
                                 Padding="12,8">
                             <Label x:Name="DetailsLabel"
                                    Text=""
                                    FontSize="14"
                                    TextColor="#666666"
                                    LineBreakMode="WordWrap"
                                    BackgroundColor="Transparent" />
                         </Border>
                    </StackLayout>
                </Border>

                <!-- Source Card -->
                <Border BackgroundColor="White" 
                        Stroke="Transparent" 
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 12"
                        Padding="20">
                    <StackLayout Spacing="12">
                        <Label Text="ðŸ”— Source"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#333333" />
                                                 <Border BackgroundColor="#E3F2FD"
                                 Stroke="Transparent"
                                 StrokeThickness="0"
                                 StrokeShape="RoundRectangle 8"
                                 Padding="12,8">
                             <Label x:Name="SourceLabel"
                                    Text=""
                                    FontSize="14"
                                    TextColor="#2196F3"
                                    LineBreakMode="WordWrap"
                                    BackgroundColor="Transparent">
                                 <Label.GestureRecognizers>
                                     <TapGestureRecognizer Tapped="OnSourceTapped" />
                                 </Label.GestureRecognizers>
                             </Label>
                         </Border>
                    </StackLayout>
                </Border>

            </StackLayout>
        </ScrollView>

        <!-- Loading Overlay -->
        <Grid x:Name="LoadingOverlay" 
              Grid.Row="1" 
              BackgroundColor="#80000000"
              IsVisible="False">
            <ActivityIndicator x:Name="LoadingIndicator"
                              IsRunning="False"
                              IsVisible="False"
                              Color="White"
                              HorizontalOptions="Center"
                              VerticalOptions="Center" />
        </Grid>
    </Grid>
</ContentPage>
